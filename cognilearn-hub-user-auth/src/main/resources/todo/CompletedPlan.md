1. 实现：用逻辑删除后可注册同名用户 &&  用户注册事务处理，解决并发问题（2025.6.18完成）

问题：**用逻辑删除后可注册同名用户，那“用户名唯一性校验”，**经典陷阱**：**逻辑删除的用户仍然可能阻止新用户注册相同用户名**，或者**导致唯一索引冲突**

最终方案：(user_name, is_del, del_version)唯一索引兜底+redis分布式锁（锁粒度按用户名）并发控制，确保最终一致性

is_del按Java通用开发手册，取值范围为0,1

参考：mybatisplus的方法：将逻辑删除字段改为时间类型  或者  (user_name, is_del, del_version) 符合数据库范式

其他方案：**分离表方案**（活跃/历史数据分表存储，跨表操作的原子性与**删除时间**）；

2.用户通过账号+密码登录系统，获取 Access Token 和 Refresh Token，用于后续身份验证。

流程图：

![image.png](assets/image.png?t=1753853744351)

经分析[有缓存穿透的风险：用redis做布隆过滤器](https://)（**布隆过滤器可以判断某个数据一定不存在，但是无法判断一定存在**。）

布隆过滤器：一种数据结构，是由一串很长的二进制向量组成，可以将其看成一个二进制数组。

向布隆过滤器中添加一个元素key时，我们通过多个hash函数，算出一个值，然后将这个值所在的方格置为1。

　　优点：优点很明显，二进制组成的数组，占用内存极少，并且插入和查询速度都足够快。

　　缺点：随着数据的增加，误判率会增加；还有无法判断数据一定存在；另外还有一个重要缺点，无法删除数据。

3.首次使用系统时创建账号，需邮箱验证码验证，创建成功后可直接登录或跳转登录流程。


| 问题     | 原因                               | 防御方法                         |
| -------- | ---------------------------------- | -------------------------------- |
| 缓存穿透 | 缓存无数据且请求不存在的数据       | 缓存空结果、布隆过滤器、参数校验 |
| 缓存击穿 | 热点数据失效，瞬间大量请求击穿缓存 | 互斥锁、逻辑过期、缓存预热       |
| 缓存雪崩 | 大量缓存同一时间失效               | 随机过期、限流降级、多级缓存     |
