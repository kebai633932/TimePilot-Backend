认证模块 Spring Security + BCrypt +**TinyID**分布式ID + RBAC+JWT

登录，注册，认证，授权

-- 用户表
CREATE TABLE `user` (
`id` BIGINT UNSIGNED NOT NULL COMMENT '用户ID（雪花算法生成）',
`username` VARCHAR(50) NOT NULL COMMENT '登录用户名',
`real_name` VARCHAR(50) NOT NULL COMMENT '真实姓名',
`password` VARCHAR(100) NOT NULL COMMENT 'BCrypt加密密码',
`email` VARCHAR(100) COMMENT '邮箱（脱敏存储）',
`phone` VARCHAR(20) COMMENT '手机号（脱敏，如138****1234）',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`last_login_time` DATETIME COMMENT '最后登录时间',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`update_time` DATETIME ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
PRIMARY KEY (`id`),
UNIQUE INDEX `uk_user_username` (`username`),
UNIQUE INDEX `uk_user_email` (`email`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户账户表';

-- 角色表
CREATE TABLE `role` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '角色ID',
`code` VARCHAR(20) NOT NULL COMMENT '角色编码（如ROLE_ADMIN）',
`name` VARCHAR(50) NOT NULL COMMENT '角色名称',
`description` VARCHAR(200) COMMENT '角色描述',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`update_time` DATETIME ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
PRIMARY KEY (`id`),
UNIQUE INDEX `uk_role_code` (`code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色定义表';

-- 权限表
CREATE TABLE `permission` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '权限ID',
`code` VARCHAR(50) NOT NULL COMMENT '权限标识（如user:delete）',
`name` VARCHAR(100) NOT NULL COMMENT '权限名称',
`type` TINYINT NOT NULL COMMENT '类型：1-菜单, 2-按钮, 3-API',
`url` VARCHAR(200) COMMENT '资源路径（如/api/users）',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`update_time` DATETIME ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
PRIMARY KEY (`id`),
UNIQUE INDEX `uk_permission_code` (`code`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='权限明细表';

-- 用户角色关联表
CREATE TABLE `user_role` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '关联ID',
`user_id` BIGINT UNSIGNED NOT NULL COMMENT '用户ID',
`role_id` BIGINT UNSIGNED NOT NULL COMMENT '角色ID',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`update_time` DATETIME ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
PRIMARY KEY (`id`),
UNIQUE INDEX `uk_user_role` (`user_id`, `role_id`),
INDEX `idx_user_role_role_id` (`role_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户角色关联表';

-- 角色权限关联表
CREATE TABLE `role_permission` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '关联ID',
`role_id` BIGINT UNSIGNED NOT NULL COMMENT '角色ID',
`permission_id` BIGINT UNSIGNED NOT NULL COMMENT '权限ID',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
`update_time` DATETIME ON UPDATE CURRENT_TIMESTAMP COMMENT '修改时间',
PRIMARY KEY (`id`),
UNIQUE INDEX `uk_role_permission` (`role_id`, `permission_id`),
INDEX `idx_role_perm_perm_id` (`permission_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='角色权限关联表';

-- 登录日志表
CREATE TABLE `login_log` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '日志ID（雪花算法）',
`user_id` BIGINT UNSIGNED NOT NULL COMMENT '用户ID',
`ip` VARCHAR(50) NOT NULL COMMENT '登录IP',
`user_agent` TEXT COMMENT '设备信息（加密存储）',
`status` TINYINT NOT NULL COMMENT '状态：0-失败, 1-成功',
`location` VARCHAR(100) COMMENT 'IP归属地',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
PRIMARY KEY (`id`),
INDEX `idx_login_log_user` (`user_id`),
INDEX `idx_login_log_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户登录日志表';

-- 操作日志表
CREATE TABLE `operation_log` (
`id` BIGINT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '日志ID（雪花算法）',
`user_id` BIGINT UNSIGNED NOT NULL COMMENT '操作用户ID',
`module` VARCHAR(50) NOT NULL COMMENT '操作模块（如用户管理）',
`type` VARCHAR(20) NOT NULL COMMENT '操作类型（如CREATE/DELETE）',
`content` TEXT COMMENT '操作详情（加密存储）',
`is_deleted` TINYINT DEFAULT 0 COMMENT '逻辑删除：0-未删除, 1-已注销',
`create_time` DATETIME DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
PRIMARY KEY (`id`),
INDEX `idx_operation_log_user` (`user_id`),
INDEX `idx_operation_log_time` (`create_time`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户操作日志表';
